```json
{
  "name": "CIC Bot: Hỏi đáp & Nạp tài liệu tự động",
  "nodes": [
    {
      "parameters": {
        "updates": [
          "message"
        ]
      },
      "id": "tg-trigger",
      "name": "Telegram Trigger",
      "type": "n8n-nodes-base.telegramTrigger",
      "typeVersion": 1,
      "position": [
        0,
        300
      ],
      "webhookId": "tg-webhook"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "={{ $json.message.text }}",
                  "type": "string"
                },
                "conditions": [
                  {
                    "operator": "isNotEmpty"
                  }
                ]
              },
              "output": 0
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "={{ $json.message.document }}",
                  "type": "string"
                },
                "conditions": [
                  {
                    "operator": "isNotEmpty"
                  }
                ]
              },
              "output": 1
            }
          ]
        },
        "fallbackOutput": 2
      },
      "id": "route-msg",
      "name": "Phân loại tin nhắn",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 1,
      "position": [
        220,
        300
      ]
    },
    {
      "parameters": {
        "agent": "conversationalAgent",
        "promptType": "define",
        "text": "={{ $json.message.text }}",
        "options": {
          "systemMessage": "Bạn là trợ lý tri thức của CIC. Hãy dùng LightRAG để trả lời câu hỏi."
        }
      },
      "id": "ai-agent",
      "name": "AI Agent",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.6,
      "position": [
        450,
        200
      ]
    },
    {
      "parameters": {
        "operation": "getFile",
        "fileId": "={{ $json.message.document.file_id }}",
        "download": true
      },
      "id": "get-file",
      "name": "Tải file từ Telegram",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [
        450,
        450
      ],
      "credentials": {
        "telegramApi": {
          "id": "1",
          "name": "Telegram Bot API"
        }
      }
    },
    {
      "parameters": {
        "operation": "pdf",
        "binaryPropertyName": "data"
      },
      "id": "extract-text",
      "name": "Trích xuất tài liệu",
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        650,
        450
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://web-production-your-link.up.railway.app/api/lightrag/insert",
        "sendBody": true,
        "contentType": "json",
        "bodyParameters": {
          "parameters": [
            {
              "name": "text",
              "value": "={{ $json.text }}"
            }
          ]
        }
      },
      "id": "insert-lightrag",
      "name": "Nạp vào LightRAG",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [
        850,
        450
      ]
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "✅ Đã nạp kiến thức mới thành công! Anh có thể hỏi em về tài liệu này rồi ạ.",
        "additionalFields": {}
      },
      "id": "confirm-msg",
      "name": "Thông báo thành công",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [
        1050,
        450
      ]
    }
  ],
  "connections": {
    "Telegram Trigger": {
      "main": [
        [
          {
            "node": "Phân loại tin nhắn",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Phân loại tin nhắn": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Tải file từ Telegram",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Tải file từ Telegram": {
      "main": [
        [
          {
            "node": "Trích xuất tài liệu",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Trích xuất tài liệu": {
      "main": [
        [
          {
            "node": "Nạp vào LightRAG",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Nạp vào LightRAG": {
      "main": [
        [
          {
            "node": "Thông báo thành công",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": [],
  "triggerCount": 1,
  "updatedAt": "2026-01-20T03:48:00.000Z",
  "versionId": "1"
}
```